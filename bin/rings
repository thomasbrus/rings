#!/usr/bin/env ruby

require 'rings'

# Start the server
server = Rings::Server.new
puts "Rings Server started on port #{server.port}."

# Gracefully exit with ctrl-c
trap('INT') { Kernel.exit(0) }

loop do
  Thread.abort_on_exception = true
  # Accept any client and set up a client handler
  Thread.start(server.accept) do |client|
    Rings::ClientHandler.new server, client
  end
end